$(document).ready(function(){$("#buttonFilter").on("click",function(a){if(a=JSON.parse(localStorage.getItem("Diretor")))$("#filterDiretor").val(a),$("#filterDiretor").trigger("change");if(a=JSON.parse(localStorage.getItem("Gerente")))$("#filterGerente").val(a),$("#filterGerente").trigger("change");if(a=JSON.parse(localStorage.getItem("Representante")))$("#filterRepresentante").val(a),$("#filterRepresentante").trigger("change");if(a=JSON.parse(localStorage.getItem("Corretora")))$("#filterCorretora").val(a),
$("#filterCorretora").trigger("change");if(a=JSON.parse(localStorage.getItem("Estrutura")))$("#filterEstrutura").val(a),$("#filterEstrutura").trigger("change");if(a=JSON.parse(localStorage.getItem("Produtor")))$("#filterProdutor").val(a),$("#filterProdutor").trigger("change");if(a=JSON.parse(localStorage.getItem("Inspetor")))$("#filterInspetor").val(a),$("#filterInspetor").trigger("change")});$("#filterDiretor").on("change",function(a){$("#filterGerente").find("option").remove();$("#filterRepresentante").find("option").remove();
$("#filterCorretora").find("option").remove();$("#filterEstrutura").find("option").remove();$("#filterProdutor").find("option").remove();$("#filterInspetor").find("option").remove();$("#filterDiretor").val().forEach(function(a){setGeral(a,null,null,1,null,1,null,1,null,1,null,1,null,1,null,1)});setLocalStorage("Diretor");$(".multiselect").select2("destroy");$(".multiselect").select2()});$("#filterGerente").on("change",function(a){$("#filterDiretor").find("option").remove();$("#filterRepresentante").find("option").remove();
$("#filterCorretora").find("option").remove();$("#filterEstrutura").find("option").remove();$("#filterProdutor").find("option").remove();$("#filterInspetor").find("option").remove();$("#filterGerente").val().forEach(function(a){setGeral(null,1,a,null,null,1,null,1,null,1,null,1,null,1,null,1)});setLocalStorage("Gerente");$(".multiselect").select2("destroy");$(".multiselect").select2()});$("#filterRepresentante").on("change",function(a){$("#filterDiretor").find("option").remove();$("#filterGerente").find("option").remove();
$("#filterCorretora").find("option").remove();$("#filterEstrutura").find("option").remove();$("#filterProdutor").find("option").remove();$("#filterInspetor").find("option").remove();$("#filterRepresentante").val().forEach(function(a){setGeral(null,1,null,1,a,null,null,1,null,1,null,1,null,1,null,1)});setLocalStorage("Representante");$(".multiselect").select2("destroy");$(".multiselect").select2()});$("#filterCorretora").on("change",function(a){$("#filterDiretor").find("option").remove();$("#filterGerente").find("option").remove();
$("#filterRepresentante").find("option").remove();$("#filterEstrutura").find("option").remove();$("#filterProdutor").find("option").remove();$("#filterInspetor").find("option").remove();$("#filterCorretora").val().forEach(function(a){setGeral(null,1,null,1,null,1,a,null,null,1,null,1,null,1,null,1)});setLocalStorage("Corretora");$(".multiselect").select2("destroy");$(".multiselect").select2()});$("#filterEstrutura").on("change",function(a){$("#filterDiretor").find("option").remove();$("#filterGerente").find("option").remove();
$("#filterRepresentante").find("option").remove();$("#filterCorretora").find("option").remove();$("#filterProdutor").find("option").remove();$("#filterInspetor").find("option").remove();$("#filterEstrutura").val().forEach(function(a){setGeral(null,1,null,1,null,1,null,1,null,1,a,null,null,1,null,1)});setLocalStorage("Estrutura");$(".multiselect").select2("destroy");$(".multiselect").select2()});$("#filterProdutor").on("change",function(a){$("#filterDiretor").find("option").remove();$("#filterGerente").find("option").remove();
$("#filterRepresentante").find("option").remove();$("#filterCorretora").find("option").remove();$("#filterEstrutura").find("option").remove();$("#filterInspetor").find("option").remove();$("#filterProdutor").val().forEach(function(a){setGeral(null,1,null,1,null,1,null,1,null,1,null,1,a,null,null,1)});setLocalStorage("Produtor");$(".multiselect").select2("destroy");$(".multiselect").select2()});$("#filterInspetor").on("change",function(a){$("#filterDiretor").find("option").remove();$("#filterGerente").find("option").remove();
$("#filterRepresentante").find("option").remove();$("#filterCorretora").find("option").remove();$("#filterEstrutura").find("option").remove();$("#filterInspetor").val().forEach(function(a){setGeral(null,1,null,1,null,1,null,1,null,1,null,1,null,1,a,null)});setLocalStorage("Inspetor");$(".multiselect").select2("destroy");$(".multiselect").select2()})});
function setLocalStorage(a){var d=[];$("#filter"+a+" option").each(function(){this.selected&&d.push(this.value)});localStorage.setItem(a,JSON.stringify(d))}
function setGeral(a,d,c,g,e,l,h,k,f,b,m,r,n,t,p,u,q){a=void 0===a?null:a;d=void 0===d?null:d;c=void 0===c?null:c;g=void 0===g?null:g;e=void 0===e?null:e;l=void 0===l?null:l;h=void 0===h?null:h;k=void 0===k?null:k;f=void 0===f?null:f;m=void 0===m?null:m;r=void 0===r?null:r;n=void 0===n?null:n;t=void 0===t?null:t;p=void 0===p?null:p;u=void 0===u?null:u;q=void 0===q?!0:q;var v={},w={},x={},y={},z={},A={};b={};for(i=0;i<document.arrFilter.length;i++)null!=document.arrFilter[i].diretorCodigo&&null!=document.arrFilter[i].diretorNome&&
"-1"!=document.arrFilter[i].diretorCodigo&&null!=d&&validation(document.arrFilter[i],a,c,e,h,f,m,n,p)&&(v[document.arrFilter[i].diretorCodigo]=document.arrFilter[i].diretorNome),null!=document.arrFilter[i].gerenteCodigo&&null!=document.arrFilter[i].gerenteNome&&"-1"!=document.arrFilter[i].gerenteCodigo&&null!=g&&validation(document.arrFilter[i],a,c,e,h,f,m,n,p)&&(w[document.arrFilter[i].gerenteCodigo]=document.arrFilter[i].gerenteNome),null!=document.arrFilter[i].representanteCodigo&&null!=document.arrFilter[i].representanteNome&&
"-1"!=document.arrFilter[i].representanteCodigo&&null!=l&&validation(document.arrFilter[i],a,c,e,h,f,m,n,p)&&(x[document.arrFilter[i].representanteCodigo]=document.arrFilter[i].representanteNome),null!=document.arrFilter[i].id_corretora&&null!=document.arrFilter[i].corretor_nome&&"-1"!=document.arrFilter[i].id_corretora&&null!=k&&validation(document.arrFilter[i],a,c,e,h,f,m,n,p)&&(y[document.arrFilter[i].id_corretora]=document.arrFilter[i].corretor_nome),null!=document.arrFilter[i].estruturaVenda&&
null!=document.arrFilter[i].estruturaVenda&&"-1"!=document.arrFilter[i].estruturaVenda&&null!=r&&validation(document.arrFilter[i],a,c,e,h,f,m,n,p)&&(z[document.arrFilter[i].estruturaVenda]=document.arrFilter[i].estruturaVenda),null!=document.arrFilter[i].id_produtor&&null!=document.arrFilter[i].produtor_nome&&"-1"!=document.arrFilter[i].id_produtor&&null!=t&&validation(document.arrFilter[i],a,c,e,h,f,m,n,p)&&(A[document.arrFilter[i].id_produtor]=document.arrFilter[i].produtor_nome),null!=document.arrFilter[i].inspetorCodigo&&
null!=document.arrFilter[i].inspetorNome&&"-1"!=document.arrFilter[i].inspetorCodigo&&null!=u&&validation(document.arrFilter[i],a,c,e,h,f,m,n,p)&&(b[document.arrFilter[i].inspetorCodigo]=document.arrFilter[i].inspetorNome);console.log("acabou o loop");null!=d&&(d=createOptions(document.getElementById("filterDiretor"),v),q&&(a=$("#filterDiretor").val(),a.push(d),$("#filterDiretor").val(a)),1==Object.keys(v).length?$("#filterDiretor").attr("readonly","readonly"):$("#filterDiretor").removeAttr("readonly"));
null!=g&&(g=createOptions(document.getElementById("filterGerente"),w),q&&(a=$("#filterGerente").val(),a.push(g),$("#filterGerente").val(a)),1==Object.keys(w).length?$("#filterGerente").attr("readonly","readonly"):$("#filterGerente").removeAttr("readonly"));null!=l&&(l=createOptions(document.getElementById("filterRepresentante"),x),q&&(a=$("#filterRepresentante").val(),a.push(l),$("#filterRepresentante").val(a)),1==Object.keys(x).length?$("#filterRepresentante").attr("readonly","readonly"):$("#filterRepresentante").removeAttr("readonly"));
null!=k&&(k=createOptions(document.getElementById("filterCorretora"),y),q&&(a=$("#filterCorretora").val(),a.push(k),$("#filterCorretora").val(a)),1==Object.keys(y).length?$("#filterCorretora").attr("readonly","readonly"):$("#filterCorretora").removeAttr("readonly"));null!=r&&(r=createOptions(document.getElementById("filterEstrutura"),z),q&&(a=$("#filterEstrutura").val(),a.push(r),$("#filterEstrutura").val(a)),1==Object.keys(z).length?$("#filterEstrutura").attr("readonly","readonly"):$("#filterEstrutura").removeAttr("readonly"));
null!=t&&(t=createOptions(document.getElementById("filterProdutor"),A),q&&(a=$("#filterProdutor").val(),a.push(t),$("#filterProdutor").val(a)),1==Object.keys(A).length?$("#filterProdutor").attr("readonly","readonly"):$("#filterProdutor").removeAttr("readonly"));null!=u&&(u=createOptions(document.getElementById("filterInspetor"),b),q&&(a=$("#filterInspetor").val(),a.push(u),$("#filterInspetor").val(a)),1==Object.keys(b).length?$("#filterInspetor").attr("readonly","readonly"):$("#filterInspetor").removeAttr("readonly"))}
function setMidia(a,d,c,g,e,l,h,k,f){var b={};$.each(document.midias,function(a,f){b[f.corretor_type]=f.corretor_type});$("#filterMidia").html(createHtmlSelect(b,$("#filterMidia").val()?$("#filterMidia").val():document.filterMidia))}function setRegioes(a,d,c,g,e,l,h,k,f){var b={};$.each(document.regioes,function(a,f){b[f.regiao]=f.regiao});$("#filterRegiao").html(createHtmlSelect(b,$("#filterRegiao").val()?$("#filterRegiao").val():document.filterRegiao))}
function createOptions(a,d){if(a){var c=[];$.each(sortProperties(d),function(d,e){var g=document.createElement("option");g.value=e[0];g.text=e[1];a.add(g);c.push(e[0])});return c}}function createHtmlSelect(a,d){var c=1<Object.keys(a).length?"<option value=''>selecionar...</option>":"";c="";$.each(sortProperties(a),function(a,e){c+="<option value='"+e[0]+"' "+(e[0]==d?"selected":"")+">"+e[1]+"</option>"});return c}
function validation(a,d,c,g,e,l,h,k,f){d=void 0===d?null:d;c=void 0===c?null:c;g=void 0===g?null:g;e=void 0===e?null:e;h=void 0===h?null:h;k=void 0===k?null:k;f=void 0===f?null:f;return null!=d&&""!=d&&a.diretorCodigo!=d||null!=c&&""!=c&&a.gerenteCodigo!=c||null!=g&&""!=g&&a.representanteCodigo!=g||null!=e&&""!=e&&a.id_corretora!=e||null!=h&&""!=h&&a.estruturaVenda!=h||null!=k&&""!=k&&a.id_produtor!=k||null!=f&&""!=f&&a.dataInspetor!=f?!1:!0}
var roundToPlusInfinity=function(a,d){console.log("passou roundToPlusInfinity");var c=Math.pow(10,d);return(d?Math.floor(a*c+.5)/c:Math.round(a)).toString()};function sortProperties(a){var d=[],c;for(c in a)a.hasOwnProperty(c)&&d.push([c,a[c]]);d.sort(function(a,c){var d=a[1].toLowerCase(),e=c[1].toLowerCase();return d<e?-1:d>e?1:0});return d}
function limparFiltros(){document.filterDiretor="";document.filterGerente="";document.filterRepresentante="";document.filterCorretora="";document.filterEstrutura="";document.filterMidia="";document.filterProdutor="";document.filterInspetor="";$("#filterDiretor").find("option").remove();$("#filterGerente").find("option").remove();$("#filterRepresentante").find("option").remove();$("#filterCorretora").find("option").remove();$("#filterEstrutura").find("option").remove();$("#filterProdutor").find("option").remove();
$("#filterMidia").find("option").remove();$("#filterRegiao").find("option").remove();$("#filterInspetor").find("option").remove();localStorage.removeItem("Diretor");localStorage.removeItem("Gerente");localStorage.removeItem("Representante");localStorage.removeItem("Corretora");localStorage.removeItem("Estrutura");localStorage.removeItem("Produtor");localStorage.removeItem("Midia");localStorage.removeItem("Regiao");localStorage.removeItem("Inspetor")}
function cleanFilter(){limparFiltros();$(".multiselect").select2("destroy");$(".multiselect").select2();setGeral(null,1,null,1,null,1,null,1,null,1,null,1,null,1,null,1,!1);setMidia()}
function createTable(a){console.log("INICIOU LOADS");$(".overlayer").css("display","block");$(".overlayer2").css("display","block");$(".butaos").hide();if(void 0!=a)var d=a[0],c=a[1],g=a[2],e=a[3],l=a[4],h=a[5],k=a[6];else k=h=l=e=g=c=d=!0;$.get("/getTable?filterDiretor="+document.filterDiretor+"&filterGerente="+document.filterGerente+"&filterRepresentante="+document.filterRepresentante+"&filterCorretora="+document.filterCorretora+"&filterMidia="+document.filterMidia+"&filterProdutor="+document.filterProdutor+
"&filterEstrutura="+document.filterEstrutura+"&datas="+document.datas+"&filterRegiao="+document.filterRegiao+("&cdata="+d+"&cmidia="+c+"&cregiao="+g+"&cev="+e+"&cea="+l+"&caa="+h+"&cprodutor="+k),function(a){fullGA=JSON.parse(a);a="<table id='tabela_dados' class='table dt-responsive table-striped table-bordered' cellspacing='0' width='200%'><thead><tr><th>Data</th><th>Midia</th><th>Regi\u00e3o</th><th>EV</th><th>EA</th><th>AA</th><th>Produtor</th><th>Impress\u00f5es</th><th>Custo</th><th>Cliques</th><th>Visitas</th><th style='white-space:nowrap;'>Pr\u00e9-Cadastro</th><th style='white-space:nowrap'>Pr\u00e9-Cadastro<br> por Visitas</th><th style='white-space:nowrap'>Dados Pessoais</th><th style='white-space:nowrap'>Dados Pessoais<br> por Pr\u00e9-Cadastro</th><th>Dependentes</th><th style='white-space:nowrap'>Dependentes por<br> Dados Pessoais</th><th>Corretor</th><th style='white-space:nowrap'>Corretor por<br> Dependentes</th><th>Checkout</th><th>CPC</th><th>CPV</th><th>CPL</th><th>CPA</th><th>ROI</th><th>CTR</th><th>CR</th><th>CPV</th><th>VTR</th><th style='white-space:nowrap'>Checkout por<br> Corretor</th><th>Compra</th><th style='white-space:nowrap'>Compra por<br> Checkout</th><th style='white-space:nowrap'>Compra por<br> Visita</th><th>Receita</th><th>Vidas</th></tr></thead><tbody id='tbody_info'>";
for(var b in fullGA)a+="<tr>",a+="<td>"+fullGA[b].date+"</td>",a+="<td>"+fullGA[b].corretor_type+"</td>",a+="<td>"+fullGA[b].regiao+"</td>",a+="<td>"+fullGA[b].ev+"</td>",a+="<td>"+fullGA[b].ea+"</td>",a+="<td>"+fullGA[b].aa+"</td>",a+="<td>"+("0"==fullGA[b].nmpd?"&nbsp;":fullGA[b].nmpd)+"</td>",a+="<td>"+fullGA[b].impressions+"</td>",a+="<td>"+fullGA[b].adCost+"</td>",a+="<td>"+fullGA[b].adClicks+"</td>",a+="<td>"+fullGA[b].sessions+"</td>",a+="<td>"+fullGA[b].precadastro+"</td>",a+="<td>"+fullGA[b].precadastro_visitas+
"</td>",a+="<td>"+fullGA[b].dadospessoais+"</td>",a+="<td>"+fullGA[b].dadospessoais_precadastro+"</td>",a+="<td>"+fullGA[b].dependentes+"</td>",a+="<td>"+fullGA[b].dependentes_dadospessoais+"</td>",a+="<td>"+fullGA[b].corretor+"</td>",a+="<td>"+fullGA[b].corretor_dependentes+"</td>",a+="<td>"+fullGA[b].checkout+"</td>",a+="<td>"+(fullGA[b].adCost>fullGA[b].adClicks&&0<fullGA[b].adClicks?(fullGA[b].adCost/fullGA[b].adClicks).toFixed(2):0)+"</td>",a+="<td>"+(fullGA[b].adCost>fullGA[b].sessions&&0<fullGA[b].sessions?
(fullGA[b].adCost/fullGA[b].sessions).toFixed(2):0)+"</td>",a+="<td>"+(fullGA[b].adCost>fullGA[b].dadospessoais&&0<fullGA[b].dadospessoais?(fullGA[b].adCost/fullGA[b].dadospessoais).toFixed(2):0)+"</td>",a+="<td>"+(fullGA[b].adCost>fullGA[b].vendas&&0<fullGA[b].vendas?(fullGA[b].adCost/fullGA[b].vendas).toFixed(2):0)+"</td>",a+="<td>"+(fullGA[b].receitas>fullGA[b].adCost&&0<fullGA[b].adCost?(fullGA[b].receitas/fullGA[b].adCost).toFixed(2):0)+"</td>",a+="<td>"+(fullGA[b].adClicks>fullGA[b].impressions&&
0<fullGA[b].impressions?(fullGA[b].adClicks/fullGA[b].impressions).toFixed(2):0)+"</td>",a+="<td>"+(fullGA[b].sessions>fullGA[b].adClicks&&0<fullGA[b].adClicks?(fullGA[b].sessions/fullGA[b].adClicks).toFixed(2):0)+"</td>",a+="<td>"+(fullGA[b].adCost>fullGA[b].dependentes&&0<fullGA[b].dependentes?(fullGA[b].adCost/fullGA[b].dependentes).toFixed(2):0)+"</td>",a+="<td>"+(fullGA[b].dependentes>fullGA[b].impressions&&0<fullGA[b].impressions?(fullGA[b].dependentes/fullGA[b].impressions).toFixed(2):0)+"</td>",
a+="<td>"+fullGA[b].checkout_corretor+"</td>",a+="<td>"+fullGA[b].vendas+"</td>",a+="<td>"+(fullGA[b].vendas>=fullGA[b].checkout&&0<fullGA[b].checkout&&0<fullGA[b].vendas?(fullGA[b].vendas/fullGA[b].checkout).toFixed(2):"0")+"</td>",a+="<td>"+(fullGA[b].vendas>=fullGA[b].sessions&&0<fullGA[b].sessions&&0<fullGA[b].vendas?(fullGA[b].vendas/fullGA[b].sessions).toFixed(2):"0")+"</td>",a+="<td>"+(fullGA[b].receitas?fullGA[b].receitas.toFixed(2):"0.00")+"</td>",a+="<td>"+(fullGA[b].vidas?fullGA[b].vidas.toFixed(2):
"0")+"</td>",a+="</tr>";a+="</tbody></table>";$("#loadingTable").css("display","none");$(".overlayer").hide();$(".overlayer2").hide();$(".butaos").show();console.log("FIM LOADS");$("#divTable").html(a);$("#tabela_dados").DataTable({scrollX:!0,dom:"Bfrtip",autoWidth:!0,ordering:!0,buttons:[{extend:"copyHtml5",exportOptions:{columns:[0,":visible"]}},{extend:"excelHtml5",exportOptions:{columns:":visible"}},{extend:"print",exportOptions:{columns:":visible"}},"colvis"],language:{search:"Procurar",zeroRecords:"Nada foi Localizado",
info:"Exibindo _PAGE_ de _PAGES_",infoEmpty:"Nenhum Registro informado",paginate:{first:"Primeiro",last:"Ultimo",next:"Pr\u00f3ximo",previous:"Voltar"},buttons:{copy:"Copiar",print:"Imprimir",colvis:"Colunas"},infoFiltered:"(filtered from _MAX_ total records)"}});a=$("#tabela_dados").DataTable();a.column(0).visible(d);a.column(1).visible(c);a.column(2).visible(g);a.column(3).visible(e);a.column(4).visible(l);a.column(5).visible(h);a.column(6).visible(k);$("#tabela_dados").on("column-visibility.dt",
function(a,b,c,d){console.log("mudou visu da table");a=$("#tabela_dados").DataTable();createTable(a.columns().visible());$(".dt-button-background").trigger("click");console.log(a.columns().visible())})})};